version: "3"

tasks:
  lint:
    cmds:
      - golangci-lint run

  fix:
    cmds:
      - golangci-lint run --fix

  test:
    cmds:
      - go test -race -coverprofile=coverage.tmp.out ./...
      - cat coverage.tmp.out | grep -v "demo-app" | grep -v "platforma/docs" > coverage.out
      - go tool cover -html=coverage.out -o coverage.html

  check:
    # Using cmds here intead of deps beacuse deps run in parallel which messes up output
    cmds:
      - task lint
      - task test

  docs:
    dir: docs
    cmds:
      - bun run dev
